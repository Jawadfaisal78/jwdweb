<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S.A Samad Enterprises Billing System</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
/* ===== GLOBAL STYLES ===== */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f3f6fa;
    margin: 0;
    padding: 0;
    color: #333;
}

/* ===== HEADER ===== */
header {
    background: linear-gradient(90deg, #003E7E, #0078D7);
    color: white;
    padding: 20px;
    text-align: center;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    border-bottom-left-radius: 12px;
    border-bottom-right-radius: 12px;
}
header h1 {
    margin: 0;
    font-size: 1.8em;
    font-weight: bold;
    letter-spacing: 0.5px;
}

/* ===== MENU BUTTONS ===== */
.menu {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 15px;
}
.menu button, .load-label {
    background: #0078D7;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
}
.menu button:hover, .load-label:hover {
    background: #005fa3;
    transform: translateY(-2px);
}
#loadFile {
    display: none;
}

/* ===== MAIN SECTION ===== */
main {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 25px 10px;
    gap: 20px;
}

/* ===== ENTRY FORM ===== */
.entry-form {
    background: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 500px;
    transition: all 0.3s ease-in-out;
}
.entry-form h2 {
    text-align: center;
    margin-bottom: 15px;
    color: #00539C;
}
.entry-form input {
    width: 100%;
    margin: 6px 0;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 14px;
}
.entry-form input:focus {
    border-color: #0078D7;
    outline: none;
    box-shadow: 0 0 5px rgba(0,120,215,0.3);
}
.entry-form button {
    width: 100%;
    margin-top: 10px;
    background: #00539C;
    color: white;
    border: none;
    padding: 10px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 15px;
    transition: 0.3s;
}
.entry-form button:hover {
    background: #0078D7;
    transform: scale(1.02);
}

/* ===== BILLING ENTRIES TABLE ===== */
.entries {
    background: white;
    padding: 20px;
    border-radius: 10px;
    width: 100%;
    max-width: 900px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.entries h2 {
    text-align: center;
    color: #00539C;
    margin-bottom: 15px;
}
table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
}
th, td {
    border-bottom: 1px solid #ddd;
    text-align: left;
    padding: 10px;
}
th {
    background: #EAF1FB;
    color: #003E7E;
}
tr:nth-child(even) {background: #f9f9f9;}
tr:hover {background: #eef6ff; transition: 0.2s;}
.deleteBtn {
    background: #d9534f;
    border: none;
    color: white;
    padding: 5px 8px;
    border-radius: 4px;
    cursor: pointer;
}
.deleteBtn:hover {
    background: #c12e2a;
}

/* ===== BILLING RESULT ===== */
.billing-result {
    background: #eaf6ff;
    border-left: 4px solid #0078D7;
    padding: 12px 15px;
    margin-top: 15px;
    border-radius: 6px;
    display: none;
    line-height: 1.6;
    animation: fadeIn 0.3s ease-in-out;
}
.billing-result strong {color: #003E7E; font-weight: 600;}
@keyframes fadeIn {
    from {opacity: 0; transform: translateY(10px);}
    to {opacity:1; transform: translateY(0);}
}

/* ===== FOOTER ===== */
footer {
    background: #003E7E;
    color: white;
    text-align: center;
    padding: 12px;
    font-size: 14px;
    margin-top: 30px;
    box-shadow: 0 -2px 5px rgba(0,0,0,0.2);
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
    header h1 { font-size: 1.5em; }
    table, th, td { font-size: 13px; padding: 8px; }
    .menu { flex-direction: column; gap: 8px; }
}
@media (max-width: 480px) {
    header h1 { font-size: 1.2em; }
    .entry-form h2, .entries h2 { font-size: 1.1em; }
    button, .load-label { padding: 8px 12px; font-size: 13px; }
    .billing-result { font-size: 13px; }
}
</style>
</head>
<body>

<header>
    <h1>S.A Samad Enterprises Billing System</h1>
    <div class="menu">
        <label class="load-label" for="loadFile">Load Entries</label>
        <input type="file" id="loadFile">
        <button id="addBillingEntryBtn">Add Entry</button>
        <button id="calculateBtn">Calculate Total</button>
        <button id="invoiceBtn">Export Invoice</button>
    </div>
</header>

<main>
    <section class="entry-form">
        <h2>Add Company Billing Entry</h2>
        <input type="text" id="billingCompany" placeholder="Company Name">
        <input type="month" id="billingMonth">
        <input type="date" id="billingDate">
        <input type="number" id="billingAmount" placeholder="Total Amount">
        <input type="number" id="billingTotalDays" placeholder="Total Days in Month">
        <input type="number" id="billingDays" placeholder="Billed Days">
    </section>

    <section class="entries">
        <h2>Billing Entries</h2>
        <table id="billingTable">
            <thead>
                <tr>
                    <th>Company</th>
                    <th>Month</th>
                    <th>Date</th>
                    <th>Total Amount</th>
                    <th>Billed Days</th>
                    <th>Per Day</th>
                    <th>Billed Amount</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
        <div id="billingResult" class="billing-result"></div>
    </section>
</main>

<footer>
    <p>S.A Samad Enterprises Pvt LTD 2025</p>
</footer>

<script>
let billingEntries = [];

/* ADD BILLING ENTRY */
document.getElementById("addBillingEntryBtn").addEventListener("click", () => {
    const company = document.getElementById("billingCompany").value.trim();
    const month = document.getElementById("billingMonth").value;
    const date = document.getElementById("billingDate").value;
    const totalAmount = parseFloat(document.getElementById("billingAmount").value) || 0;
    const totalDays = parseInt(document.getElementById("billingTotalDays").value) || 30;
    const billedDays = parseInt(document.getElementById("billingDays").value) || 0;

    if(!company || !month || !date || totalAmount <= 0 || billedDays <= 0) {
        alert("Please fill all billing details correctly.");
        return;
    }

    const perDay = totalAmount / totalDays;
    const billedAmount = perDay * billedDays;

    billingEntries.push({company, month, date, totalAmount, totalDays, billedDays, perDay, billedAmount});
    updateBillingTable();
});

/* UPDATE TABLE */
function updateBillingTable() {
    const tbody = document.querySelector("#billingTable tbody");
    tbody.innerHTML = "";
    billingEntries.forEach((entry, idx) => {
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${entry.company}</td>
            <td>${entry.month}</td>
            <td>${entry.date}</td>
            <td>${entry.totalAmount.toFixed(2)}</td>
            <td>${entry.billedDays}</td>
            <td>${entry.perDay.toFixed(2)}</td>
            <td>${entry.billedAmount.toFixed(2)}</td>
            <td><button class="deleteBtn" onclick="deleteEntry(${idx})">Delete</button></td>
        `;
        tbody.appendChild(row);
    });
}

/* DELETE ENTRY */
function deleteEntry(index) {
    billingEntries.splice(index, 1);
    updateBillingTable();
}

/* CALCULATE TOTAL */
document.getElementById("calculateBtn").addEventListener("click", () => {
    if(billingEntries.length === 0) {
        alert("No billing entries to calculate.");
        return;
    }
    let total = billingEntries.reduce((sum, e) => sum + e.billedAmount, 0);
    const resultDiv = document.getElementById("billingResult");
    resultDiv.style.display = "block";
    resultDiv.innerHTML = `<strong>Total Billed Amount: </strong>${total.toFixed(2)}`;
});

/* EXPORT TO EXCEL */
document.getElementById("invoiceBtn").addEventListener("click", () => {
    if(billingEntries.length === 0) {
        alert("No entries to export.");
        return;
    }
    const wb = XLSX.utils.book_new();
    const wsData = [
        ["S.A Samad Enterprises Pvt LTD Invoice"],
        [],
        ["Company","Month","Date","Total Amount","Billed Days","Per Day","Billed Amount"]
    ];
    billingEntries.forEach(e => {
        wsData.push([e.company, e.month, e.date, e.totalAmount, e.billedDays, e.perDay, e.billedAmount]);
    });
    const ws = XLSX.utils.aoa_to_sheet(wsData);
    XLSX.utils.book_append_sheet(wb, ws, "Invoice");
    XLSX.writeFile(wb, "Samad_Enterprises_Invoice.xlsx");
});

/* LOAD ENTRIES FROM FILE */
document.getElementById("loadFile").addEventListener("change", function(e){
    const file = e.target.files[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = function(e){
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type:'array'});
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(firstSheet,{header:1});
        billingEntries = jsonData.slice(3).map(row => ({
            company: row[0] || "",
            month: row[1] || "",
            date: row[2] || "",
            totalAmount: parseFloat(row[3]) || 0,
            billedDays: parseInt(row[4]) || 0,
            perDay: parseFloat(row[5]) || 0,
            billedAmount: parseFloat(row[6]) || 0
        }));
        updateBillingTable();
    }
    reader.readAsArrayBuffer(file);
});
</script>

</body>
</html>

